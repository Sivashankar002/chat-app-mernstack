(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{130:function(e,t,s){},146:function(e,t,s){"use strict";s.r(t);var a=s(0),c=s(43),r=s.n(c),i=s(51),n=s(184),o=(s(130),s(15)),l=s(168),j=s(169),d=s(170),b=s(192),h=s(183),x=s(190),O=s(69),p=s(164),u=s(191),m=s(165),g=s(166),f=s(112),C=s(182),S=s(4);var w=()=>{const[e,t]=Object(a.useState)(!1),[s,c]=Object(a.useState)(),[r,i]=Object(a.useState)(),[n,l]=Object(a.useState)(),[j,d]=Object(a.useState)(),[b,w]=Object(a.useState)(),[v,y]=Object(a.useState)(!1),k=Object(h.a)(),E=Object(o.e)(),I=()=>t(!e);return Object(S.jsxs)(x.b,{spacing:"5px",color:"black",children:[Object(S.jsxs)(O.a,{id:"first-name",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Name"}),Object(S.jsx)(u.a,{placeholder:"Enter your Name",onChange:e=>c(e.target.value)})]}),Object(S.jsxs)(O.a,{id:"email",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Email"}),Object(S.jsx)(u.a,{placeholder:"Enter your Email",onChange:e=>i(e.target.value)})]}),Object(S.jsxs)(O.a,{id:"password",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Password"}),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(u.a,{type:e?"text":"password",placeholder:"Enter your Password",onChange:e=>d(e.target.value)}),Object(S.jsx)(g.a,{width:"4.5rem",onClick:I,children:Object(S.jsx)(f.a,{h:"1.75rem",size:"sm",children:e?"Hide":"Show"})})]})]}),Object(S.jsxs)(O.a,{id:"password",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Confirm Password"}),Object(S.jsxs)(m.a,{size:"md",children:[Object(S.jsx)(u.a,{type:e?"text":"password",placeholder:"Confirm password",onChange:e=>l(e.target.value)}),Object(S.jsx)(g.a,{width:"4.5rem",children:Object(S.jsx)(f.a,{h:"1.75rem",size:"sm",onClick:I,children:e?"Hide":"Show"})})]})]}),Object(S.jsxs)(O.a,{id:"pic",children:[Object(S.jsx)(p.a,{children:"Upload your Picture"}),Object(S.jsx)(u.a,{type:"file",p:1.5,accept:"image/*",onChange:e=>(e=>{if(y(!0),void 0===e)return k({title:"Please select an image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void y(!1);if(console.log(e),"image/jpeg"===e.type||"image/png"===e.type){const t=new FormData;t.append("file",e),t.append("upload_preset","chat-app"),t.append("cloud_name","sivashankar"),fetch("https://api.cloudinary.com/v1_1/sivashankar/image/upload",{method:"POST",body:t}).then((e=>e.json())).then((e=>{w(e.public_id.toString()),y(!1),console.log(e)})).catch((e=>{console.log(e),y(!1)}))}else k({title:"Please select an image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),y(!1)})(e.target.files[0])})]}),Object(S.jsx)(f.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(y(!0),!s||!r||!j||!n)return k({title:"Please fill all the fields!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void y(!1);if(j===n)try{const e={headers:{"Content-type":"application/json"}},{data:t}=await C.a.post("/api/user",{name:s,email:r,password:j,pic:b},e);k({title:"Registration Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(t)),y(!1),E.pushState("/chats")}catch(e){k({title:"Error Occurred!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),y(!1)}else k({title:"Passwords do not match!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})},isLoading:v,children:"Sign Up"})]})};const v=Object(a.createContext)(),y=()=>Object(a.useContext)(v);var k=e=>{let{children:t}=e;const[s,c]=Object(a.useState)(null),[r,i]=Object(a.useState)(),[n,l]=Object(a.useState)([]),j=Object(o.e)();return Object(a.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("userInfo"));c(e),console.log("User Info:",e),e||j.push("/")}),[j]),Object(S.jsx)(v.Provider,{value:{user:s,setUser:c,selectedChat:r,setSelectedChat:i,chats:n,setChats:l},children:t})};var E=()=>{const[e,t]=Object(a.useState)(!1),[s,c]=Object(a.useState)(),[r,i]=Object(a.useState)(),[n,l]=Object(a.useState)(!1),j=Object(h.a)(),d=Object(o.e)(),{setUser:b}=y();return Object(S.jsxs)(x.b,{spacing:"5px",color:"black",children:[Object(S.jsxs)(O.a,{id:"email",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Email"}),Object(S.jsx)(u.a,{value:s,type:"email",placeholder:"Enter your Email",onChange:e=>c(e.target.value)})]}),Object(S.jsxs)(O.a,{id:"password",isRequired:!0,children:[Object(S.jsx)(p.a,{children:"Password"}),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(u.a,{type:e?"text":"password",placeholder:"Enter your Password",value:r,onChange:e=>i(e.target.value)}),Object(S.jsx)(g.a,{width:"4.5rem",children:Object(S.jsx)(f.a,{h:"1.75rem",size:"sm",onClick:()=>t(!e),children:e?"Hide":"Show"})})]})]}),Object(S.jsx)(f.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(l(!0),!s||!r)return j({title:"Please fill all the fields!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void l(!1);try{const e={headers:{"Content-type":"application/json"}},{data:t}=await C.a.post("/api/user/login",{email:s,password:r},e);j({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),b(t),localStorage.setItem("userInfo",JSON.stringify(t)),l(!1),d.push("/chats")}catch(e){j({title:"Error Occurred!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),l(!1)}},isLoading:n,children:"Login"}),Object(S.jsx)(f.a,{variant:"solid",colorScheme:"red",width:"100%",onClick:()=>{c("guest@example.com"),i("123456")},children:"Get Guest User Credentials"})]})};var I=()=>{const e=Object(o.e)();return Object(a.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("userInfo"));console.log("User Info:",t),t&&e.push("/chats")}),[e]),Object(S.jsxs)(l.a,{maxW:"xl",centerContent:!0,children:[Object(S.jsx)(j.a,{d:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px",children:Object(S.jsx)(d.a,{fontSize:"4xl",fontFamily:"Work sans",color:"black",children:"Talk-A-Tive"})}),Object(S.jsx)(j.a,{bg:"white",w:"100%",p:4,borderRadius:"lg",color:"black",borderWidth:"1px",children:Object(S.jsxs)(b.e,{variant:"soft-rounded",children:[Object(S.jsxs)(b.b,{mb:"1em",children:[Object(S.jsx)(b.a,{width:"50%",children:"Login"}),Object(S.jsx)(b.a,{width:"50%",children:"Sign Up"})]}),Object(S.jsxs)(b.d,{children:[Object(S.jsx)(b.c,{children:Object(S.jsx)(E,{})}),Object(S.jsx)(b.c,{children:Object(S.jsx)(w,{})})]})]})})]})};var z=()=>Object(S.jsx)("div",{children:"ChatBox"}),P=s(173),R=s(187),F=s(186),U=s(177),A=s(194),W=s(37),_=s(167),L=s(178),N=s(179),B=s(175),J=s(174),T=s(176);var q=e=>{let{user:t,children:s}=e;const{isOpen:a,onOpen:c,onClose:r}=Object(P.a)();return Object(S.jsxs)(S.Fragment,{children:[s?Object(S.jsx)("span",{onClick:c,children:s}):Object(S.jsx)(J.a,{d:{base:"flex"},icon:Object(S.jsx)(B.a,{}),onClick:c}),Object(S.jsxs)(W.a,{size:"lg",isOpen:a,onClose:r,isCentered:!0,children:[Object(S.jsx)(W.h,{}),Object(S.jsxs)(W.d,{h:"410px",children:[Object(S.jsx)(W.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:t.name}),Object(S.jsx)(W.c,{}),Object(S.jsxs)(W.b,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[Object(S.jsx)(T.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),Object(S.jsxs)(d.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",children:["Email:",t.email]})]}),Object(S.jsxs)(W.f,{children:[Object(S.jsx)(f.a,{colorScheme:"blue",mr:3,onClick:r,children:"Close"}),Object(S.jsx)(f.a,{variant:"ghost",children:"Secondary Action"})]})]})]})]})},$=s(185);var G=()=>Object(S.jsxs)(x.a,{children:[Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"}),Object(S.jsx)($.a,{height:"45px"})]});var H=e=>{let{user:t,handleFunction:s}=e;return Object(S.jsxs)(j.a,{onClick:s,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(S.jsx)(U.a,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),Object(S.jsxs)(j.a,{children:[Object(S.jsx)(d.a,{children:t.name}),Object(S.jsxs)(d.a,{fontSize:"xs",children:[Object(S.jsx)("b",{children:"Email : "}),t.email]})]})]})};var D=()=>{const[e,t]=Object(a.useState)(""),[s,c]=Object(a.useState)([]),[r,i]=Object(a.useState)(!1),[n,l]=Object(a.useState)(!1),{user:b,setSelectedChat:x,chats:O,setChats:p}=y(),m=Object(o.e)(),{isOpen:g,onOpen:w,onClose:v}=Object(P.a)(),k=Object(h.a)(),E=async e=>{try{l(!0);const t={headers:{"Content-type":"application/json",Authorization:`Bearer ${b.token}`}},{data:s}=await C.a.post("/api/chat",{userId:e},t);O.find((e=>e._id===s._id))||p([s,...O]),x(s),l(!1),v()}catch(t){k({title:"Error fetching the chat",description:t.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(j.a,{display:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px",children:[Object(S.jsx)(R.a,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end",children:Object(S.jsxs)(f.a,{variant:"ghost",onClick:w,children:[Object(S.jsx)("i",{class:"fas fa-search"}),Object(S.jsx)(d.a,{d:{base:"none",md:"flex"},px:"4",children:"Search User"})]})}),Object(S.jsx)(d.a,{fontSize:"2xl",fontFamily:"Work sans",children:"Talk-A-Tive"}),Object(S.jsxs)("div",{children:[Object(S.jsx)(F.a,{children:Object(S.jsx)(F.b,{p:1,children:Object(S.jsx)(L.a,{fontSize:"2xl",m:1})})}),Object(S.jsxs)(F.a,{children:[Object(S.jsx)(F.b,{as:f.a,rightIcon:Object(S.jsx)(N.a,{}),children:Object(S.jsx)(U.a,{size:"sm",cursor:"pointer",name:b.name,src:b.pic})}),Object(S.jsxs)(F.e,{children:[Object(S.jsx)(q,{user:b}),Object(S.jsx)(F.c,{}),Object(S.jsx)(F.d,{onClick:()=>{localStorage.removeItem("userInfo"),m.push("/")},children:"Logout"})]})]})]})]}),Object(S.jsxs)(A.a,{placement:"left",onClose:v,isOpen:g,children:[Object(S.jsx)(W.h,{}),Object(S.jsxs)(A.b,{children:[Object(S.jsx)(W.g,{borderBottomWidth:"1px",children:" Search Users"}),Object(S.jsxs)(W.b,{children:[Object(S.jsxs)(j.a,{d:"flex",pb:2,children:[Object(S.jsx)(u.a,{placeholder:"Search by name or email",mr:2,value:e,onChange:e=>t(e.target.value)}),Object(S.jsx)(f.a,{onClick:async()=>{if(e)try{i(!0);const t={headers:{Authorization:`Bearer ${b.token}`}},{data:s}=await C.a.get(`/api/user?search=${e}`,t);c(s),i(!1)}catch(t){console.error("Search error:",t.response?t.response.data:t.message),k({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),i(!1)}else k({title:"Please enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"})},children:" Go"})]}),r?Object(S.jsx)(G,{}):null===s||void 0===s?void 0:s.map((e=>Object(S.jsx)(H,{user:e,handleFunction:()=>E(e._id)},e._id))),n&&Object(S.jsx)(_.a,{ml:"auto",d:"flex"})]})]})]})]})};var M=()=>{const[e,t]=Object(a.useState)(),{selectedChat:s,setSelectedChat:c,user:r,chats:i,setChats:n}=y(),o=Object(h.a)();return Object(a.useEffect)((()=>{t(JSON.parse(localStorage.getItem("userInfo"))),(async()=>{try{const e={headers:{Authorization:`Bearer ${r.token}`}},{data:t}=await C.a.get("/api/chat",e);n(t)}catch(e){o({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})()}),[]),Object(S.jsx)("div",{children:"MyChats"})};var K=()=>{const{user:e}=y();return Object(S.jsxs)("div",{style:{width:"100%"},children:[e&&Object(S.jsx)(D,{}),Object(S.jsxs)(j.a,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px",children:[e&&Object(S.jsx)(M,{}),e&&Object(S.jsx)(z,{})]})]})};var Q=function(){return Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)(o.a,{path:"/",component:I,exact:!0}),Object(S.jsx)(o.a,{path:"/chats",component:K})]})};r.a.render(Object(S.jsx)(i.a,{children:Object(S.jsx)(k,{children:Object(S.jsx)(n.a,{children:Object(S.jsx)(Q,{})})})}),document.getElementById("root"))}},[[146,1,2]]]);
//# sourceMappingURL=main.fbf89356.chunk.js.map